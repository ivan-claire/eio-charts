apiVersion: v1
kind: Secret
metadata:
  name: {{ include "opdom.serverName" . }}
  labels:
    {{- include "opdom.labels" . | nindent 4 }}
    app.kubernetes.io/component: server
type: Opaque
stringData:
  config.json: |
    {
      "global": {
        "secret_key": {{ required "a jwt signing key is required" .Values.server.secretKey | quote }}
      },
      "database": {
        "user": "opdom",
        "pass": {{ .Values.db.password | quote }},
        "host": {{ include "opdom.dbName" . | quote }},
        "port": "3306",
        "name": "opdom"
      },
      "github": {
        "client_id": {{ .Values.github.clientId | quote }},
        "client_secret": {{ .Values.github.clientSecret | quote }}
      },
      "http": {
        "port": "8080"
      }
    }
